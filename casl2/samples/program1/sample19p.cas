$$sample19 	START
	LAD 	gr0, 	0
	CALL 	L0001
	CALL 	FLUSH
	SVC 	0
$m%gcmlcm 	DC 	0
$n%gcmlcm 	DC 	0
$gc%gcmlcm 	DC 	0
$lc%gcmlcm 	DC 	0
$a%gcmlcm 	DC 	0
$b%gcmlcm 	DC 	0
$r%gcmlcm 	DC 	0
$gcmlcm	DS	0
	POP	 gr2
	POP gr1
	ST 	gr1, 	$lc%gcmlcm
	POP gr1
	ST 	gr1, 	$gc%gcmlcm
	POP gr1
	ST 	gr1, 	$n%gcmlcm
	POP gr1
	ST 	gr1, 	$m%gcmlcm
	PUSH 	0, 	gr2
	LAD 	gr1, 	$a%gcmlcm
	PUSH 	0, 	gr1
	LD 	gr1, 	$m%gcmlcm
	LD 	gr1, 	0, 	gr1
	PUSH 	0, 	gr1
	POP 	gr2
	POP 	gr1
	ST 	gr2, 	0, 	gr1
	LAD 	gr1, 	$b%gcmlcm
	PUSH 	0, 	gr1
	LD 	gr1, 	$n%gcmlcm
	LD 	gr1, 	0, 	gr1
	PUSH 	0, 	gr1
	POP 	gr2
	POP 	gr1
	ST 	gr2, 	0, 	gr1
L0002	DS	0
	LD 	gr1, 	$b%gcmlcm
	PUSH 	0, 	gr1
	LAD 	gr1, 	0
	PUSH 	0, 	gr1
	POP 	gr2
	POP 	gr1
	CPA 	gr1, 	gr2
	JNZ 	L0004
	LD 	gr1, 	gr0
	PUSH 	0, 	gr1
	JUMP 	L0005
L0004	DS	0
	LAD 	gr1, 	1
	PUSH 	0, 	gr1
L0005	DS	0
	POP 	gr1
	CPA 	gr1, 	gr0
	JZE 	L0003
	LAD 	gr1, 	$r%gcmlcm
	PUSH 	0, 	gr1
	LD 	gr1, 	$a%gcmlcm
	PUSH 	0, 	gr1
	LD 	gr1, 	$a%gcmlcm
	PUSH 	0, 	gr1
	LD 	gr1, 	$b%gcmlcm
	PUSH 	0, 	gr1
	POP 	gr2
	POP 	gr1
	DIVA 	gr1, 	gr2
	JOV 	E0DIV
	PUSH 	0, 	gr1
	LD 	gr1, 	$b%gcmlcm
	PUSH 	0, 	gr1
	POP 	gr2
	POP 	gr1
	MULA 	gr1, 	gr2
	JOV 	EOVF
	PUSH 	0, 	gr1
	POP 	gr2
	POP 	gr1
	SUBA 	gr1, 	gr2
	JOV 	EOVF
	PUSH 	0, 	gr1
	POP 	gr2
	POP 	gr1
	ST 	gr2, 	0, 	gr1
	LAD 	gr1, 	$a%gcmlcm
	PUSH 	0, 	gr1
	LD 	gr1, 	$b%gcmlcm
	PUSH 	0, 	gr1
	POP 	gr2
	POP 	gr1
	ST 	gr2, 	0, 	gr1
	LAD 	gr1, 	$b%gcmlcm
	PUSH 	0, 	gr1
	LD 	gr1, 	$r%gcmlcm
	PUSH 	0, 	gr1
	POP 	gr2
	POP 	gr1
	ST 	gr2, 	0, 	gr1
	JUMP 	L0002
L0003	DS	0
	LD 	gr1, 	$gc%gcmlcm
	PUSH 	0, 	gr1
	LD 	gr1, 	$a%gcmlcm
	PUSH 	0, 	gr1
	POP 	gr2
	POP 	gr1
	ST 	gr2, 	0, 	gr1
	LD 	gr1, 	$lc%gcmlcm
	PUSH 	0, 	gr1
	LD 	gr1, 	$m%gcmlcm
	LD 	gr1, 	0, 	gr1
	PUSH 	0, 	gr1
	LD 	gr1, 	$gc%gcmlcm
	LD 	gr1, 	0, 	gr1
	PUSH 	0, 	gr1
	POP 	gr2
	POP 	gr1
	DIVA 	gr1, 	gr2
	JOV 	E0DIV
	PUSH 	0, 	gr1
	LD 	gr1, 	$n%gcmlcm
	LD 	gr1, 	0, 	gr1
	PUSH 	0, 	gr1
	POP 	gr2
	POP 	gr1
	MULA 	gr1, 	gr2
	JOV 	EOVF
	PUSH 	0, 	gr1
	POP 	gr2
	POP 	gr1
	ST 	gr2, 	0, 	gr1
	RET
$a%abs 	DC 	0
$b%abs 	DC 	0
$abs	DS	0
	POP	 gr2
	POP gr1
	ST 	gr1, 	$b%abs
	POP gr1
	ST 	gr1, 	$a%abs
	PUSH 	0, 	gr2
	LD 	gr1, 	$a%abs
	LD 	gr1, 	0, 	gr1
	PUSH 	0, 	gr1
	LAD 	gr1, 	0
	PUSH 	0, 	gr1
	POP 	gr2
	POP 	gr1
	CPA 	gr1, 	gr2
	JMI 	L0006
	LD 	gr1, 	gr0
	PUSH 	0, 	gr1
	JUMP 	L0007
L0006	DS	0
	LAD 	gr1, 	1
	PUSH 	0, 	gr1
L0007	DS	0
	POP 	gr1
	CPA 	gr1, 	gr0
	JZE 	L0008
	LD 	gr1, 	$b%abs
	PUSH 	0, 	gr1
	LD 	gr1, 	$a%abs
	LD 	gr1, 	0, 	gr1
	PUSH 	0, 	gr1
	LAD 	gr1, 	-1
	PUSH 	0, 	gr1
	POP 	gr2
	POP 	gr1
	MULA 	gr1, 	gr2
	JOV 	EOVF
	PUSH 	0, 	gr1
	POP 	gr2
	POP 	gr1
	ST 	gr2, 	0, 	gr1
	JUMP 	L0009
L0008	DS	0
	LD 	gr1, 	$b%abs
	PUSH 	0, 	gr1
	LD 	gr1, 	$a%abs
	LD 	gr1, 	0, 	gr1
	PUSH 	0, 	gr1
	POP 	gr2
	POP 	gr1
	ST 	gr2, 	0, 	gr1
L0009	DS	0
	RET
$a%gcm 	DC 	0
$b%gcm 	DC 	0
$gc%gcm 	DC 	0
$lc%gcm 	DC 	0
$aa%gcm 	DC 	0
$bb%gcm 	DC 	0
$gcm	DS	0
	POP	 gr2
	POP gr1
	ST 	gr1, 	$gc%gcm
	POP gr1
	ST 	gr1, 	$b%gcm
	POP gr1
	ST 	gr1, 	$a%gcm
	PUSH 	0, 	gr2
	LD 	gr1, 	$a%gcm
	LD 	gr1, 	0, 	gr1
	PUSH 	0, 	gr1
	LAD 	gr1, 	0
	PUSH 	0, 	gr1
	POP 	gr2
	POP 	gr1
	CPA 	gr1, 	gr2
	JZE 	L0010
	LD 	gr1, 	gr0
	PUSH 	0, 	gr1
	JUMP 	L0011
L0010	DS	0
	LAD 	gr1, 	1
	PUSH 	0, 	gr1
L0011	DS	0
	LD 	gr1, 	$b%gcm
	LD 	gr1, 	0, 	gr1
	PUSH 	0, 	gr1
	LAD 	gr1, 	0
	PUSH 	0, 	gr1
	POP 	gr2
	POP 	gr1
	CPA 	gr1, 	gr2
	JZE 	L0012
	LD 	gr1, 	gr0
	PUSH 	0, 	gr1
	JUMP 	L0013
L0012	DS	0
	LAD 	gr1, 	1
	PUSH 	0, 	gr1
L0013	DS	0
	POP 	gr2
	POP 	gr1
	OR 	gr1, 	gr2
	PUSH 	0, 	gr1
	POP 	gr1
	CPA 	gr1, 	gr0
	JZE 	L0014
	LD 	gr1, 	$gc%gcm
	PUSH 	0, 	gr1
	LAD 	gr1, 	1
	PUSH 	0, 	gr1
	POP 	gr2
	POP 	gr1
	ST 	gr2, 	0, 	gr1
	JUMP 	L0015
L0014	DS	0
	LD 	gr1, 	$a%gcm
	PUSH 	0, 	gr1
	LAD 	gr1, 	$aa%gcm
	PUSH 	0, 	gr1
	CALL $abs
	LD 	gr1, 	$b%gcm
	PUSH 	0, 	gr1
	LAD 	gr1, 	$bb%gcm
	PUSH 	0, 	gr1
	CALL $abs
	LAD 	gr1, 	$aa%gcm
	PUSH 	0, 	gr1
	LAD 	gr1, 	$bb%gcm
	PUSH 	0, 	gr1
	LD 	gr1, 	$gc%gcm
	PUSH 	0, 	gr1
	LAD 	gr1, 	$lc%gcm
	PUSH 	0, 	gr1
	CALL $gcmlcm
L0015	DS	0
	RET
$a%lcm 	DC 	0
$b%lcm 	DC 	0
$lc%lcm 	DC 	0
$gc%lcm 	DC 	0
$aa%lcm 	DC 	0
$bb%lcm 	DC 	0
$lcm	DS	0
	POP	 gr2
	POP gr1
	ST 	gr1, 	$lc%lcm
	POP gr1
	ST 	gr1, 	$b%lcm
	POP gr1
	ST 	gr1, 	$a%lcm
	PUSH 	0, 	gr2
	LD 	gr1, 	$a%lcm
	LD 	gr1, 	0, 	gr1
	PUSH 	0, 	gr1
	LAD 	gr1, 	0
	PUSH 	0, 	gr1
	POP 	gr2
	POP 	gr1
	CPA 	gr1, 	gr2
	JZE 	L0016
	LD 	gr1, 	gr0
	PUSH 	0, 	gr1
	JUMP 	L0017
L0016	DS	0
	LAD 	gr1, 	1
	PUSH 	0, 	gr1
L0017	DS	0
	LD 	gr1, 	$b%lcm
	LD 	gr1, 	0, 	gr1
	PUSH 	0, 	gr1
	LAD 	gr1, 	0
	PUSH 	0, 	gr1
	POP 	gr2
	POP 	gr1
	CPA 	gr1, 	gr2
	JZE 	L0018
	LD 	gr1, 	gr0
	PUSH 	0, 	gr1
	JUMP 	L0019
L0018	DS	0
	LAD 	gr1, 	1
	PUSH 	0, 	gr1
L0019	DS	0
	POP 	gr2
	POP 	gr1
	OR 	gr1, 	gr2
	PUSH 	0, 	gr1
	POP 	gr1
	CPA 	gr1, 	gr0
	JZE 	L0020
	LD 	gr1, 	$lc%lcm
	PUSH 	0, 	gr1
	LAD 	gr1, 	1
	PUSH 	0, 	gr1
	POP 	gr2
	POP 	gr1
	ST 	gr2, 	0, 	gr1
	JUMP 	L0021
L0020	DS	0
	LD 	gr1, 	$a%lcm
	PUSH 	0, 	gr1
	LAD 	gr1, 	$aa%lcm
	PUSH 	0, 	gr1
	CALL $abs
	LD 	gr1, 	$b%lcm
	PUSH 	0, 	gr1
	LAD 	gr1, 	$bb%lcm
	PUSH 	0, 	gr1
	CALL $abs
	LAD 	gr1, 	$aa%lcm
	PUSH 	0, 	gr1
	LAD 	gr1, 	$bb%lcm
	PUSH 	0, 	gr1
	LAD 	gr1, 	$gc%lcm
	PUSH 	0, 	gr1
	LD 	gr1, 	$lc%lcm
	PUSH 	0, 	gr1
	CALL $gcmlcm
L0021	DS	0
	RET
$a1%reduce 	DC 	0
$a2%reduce 	DC 	0
$gc%reduce 	DC 	0
$reduce	DS	0
	POP	 gr2
	POP gr1
	ST 	gr1, 	$a2%reduce
	POP gr1
	ST 	gr1, 	$a1%reduce
	PUSH 	0, 	gr2
	LD 	gr1, 	$a1%reduce
	LD 	gr1, 	0, 	gr1
	PUSH 	0, 	gr1
	LAD 	gr1, 	0
	PUSH 	0, 	gr1
	POP 	gr2
	POP 	gr1
	CPA 	gr1, 	gr2
	JZE 	L0022
	LD 	gr1, 	gr0
	PUSH 	0, 	gr1
	JUMP 	L0023
L0022	DS	0
	LAD 	gr1, 	1
	PUSH 	0, 	gr1
L0023	DS	0
	POP 	gr1
	CPA 	gr1, 	gr0
	JZE 	L0024
	LD 	gr1, 	$a2%reduce
	PUSH 	0, 	gr1
	LAD 	gr1, 	1
	PUSH 	0, 	gr1
	POP 	gr2
	POP 	gr1
	ST 	gr2, 	0, 	gr1
	RET
L0024	DS	0
	LD 	gr1, 	$a2%reduce
	LD 	gr1, 	0, 	gr1
	PUSH 	0, 	gr1
	LAD 	gr1, 	0
	PUSH 	0, 	gr1
	POP 	gr2
	POP 	gr1
	CPA 	gr1, 	gr2
	JZE 	L0025
	LD 	gr1, 	gr0
	PUSH 	0, 	gr1
	JUMP 	L0026
L0025	DS	0
	LAD 	gr1, 	1
	PUSH 	0, 	gr1
L0026	DS	0
	POP 	gr1
	CPA 	gr1, 	gr0
	JZE 	L0027
	LD 	gr1, 	$a1%reduce
	PUSH 	0, 	gr1
	LAD 	gr1, 	1
	PUSH 	0, 	gr1
	POP 	gr2
	POP 	gr1
	ST 	gr2, 	0, 	gr1
	RET
L0027	DS	0
	LD 	gr1, 	$a2%reduce
	LD 	gr1, 	0, 	gr1
	PUSH 	0, 	gr1
	LAD 	gr1, 	0
	PUSH 	0, 	gr1
	POP 	gr2
	POP 	gr1
	CPA 	gr1, 	gr2
	JMI 	L0028
	LD 	gr1, 	gr0
	PUSH 	0, 	gr1
	JUMP 	L0029
L0028	DS	0
	LAD 	gr1, 	1
	PUSH 	0, 	gr1
L0029	DS	0
	POP 	gr1
	CPA 	gr1, 	gr0
	JZE 	L0030
	LD 	gr1, 	$a2%reduce
	PUSH 	0, 	gr1
	LD 	gr1, 	$a2%reduce
	LD 	gr1, 	0, 	gr1
	PUSH 	0, 	gr1
	LAD 	gr1, 	-1
	PUSH 	0, 	gr1
	POP 	gr2
	POP 	gr1
	MULA 	gr1, 	gr2
	JOV 	EOVF
	PUSH 	0, 	gr1
	POP 	gr2
	POP 	gr1
	ST 	gr2, 	0, 	gr1
	LD 	gr1, 	$a1%reduce
	PUSH 	0, 	gr1
	LD 	gr1, 	$a1%reduce
	LD 	gr1, 	0, 	gr1
	PUSH 	0, 	gr1
	LAD 	gr1, 	-1
	PUSH 	0, 	gr1
	POP 	gr2
	POP 	gr1
	MULA 	gr1, 	gr2
	JOV 	EOVF
	PUSH 	0, 	gr1
	POP 	gr2
	POP 	gr1
	ST 	gr2, 	0, 	gr1
L0030	DS	0
	LD 	gr1, 	$a1%reduce
	PUSH 	0, 	gr1
	LD 	gr1, 	$a2%reduce
	PUSH 	0, 	gr1
	LAD 	gr1, 	$gc%reduce
	PUSH 	0, 	gr1
	CALL $gcm
	LD 	gr1, 	$a1%reduce
	PUSH 	0, 	gr1
	LD 	gr1, 	$a1%reduce
	LD 	gr1, 	0, 	gr1
	PUSH 	0, 	gr1
	LD 	gr1, 	$gc%reduce
	PUSH 	0, 	gr1
	POP 	gr2
	POP 	gr1
	DIVA 	gr1, 	gr2
	JOV 	E0DIV
	PUSH 	0, 	gr1
	POP 	gr2
	POP 	gr1
	ST 	gr2, 	0, 	gr1
	LD 	gr1, 	$a2%reduce
	PUSH 	0, 	gr1
	LD 	gr1, 	$a2%reduce
	LD 	gr1, 	0, 	gr1
	PUSH 	0, 	gr1
	LD 	gr1, 	$gc%reduce
	PUSH 	0, 	gr1
	POP 	gr2
	POP 	gr1
	DIVA 	gr1, 	gr2
	JOV 	E0DIV
	PUSH 	0, 	gr1
	POP 	gr2
	POP 	gr1
	ST 	gr2, 	0, 	gr1
	RET
$x1%sum 	DC 	0
$x2%sum 	DC 	0
$y1%sum 	DC 	0
$y2%sum 	DC 	0
$lc%sum 	DC 	0
$y11%sum 	DC 	0
$sum	DS	0
	POP	 gr2
	POP gr1
	ST 	gr1, 	$y2%sum
	POP gr1
	ST 	gr1, 	$y1%sum
	POP gr1
	ST 	gr1, 	$x2%sum
	POP gr1
	ST 	gr1, 	$x1%sum
	PUSH 	0, 	gr2
	LD 	gr1, 	$x2%sum
	PUSH 	0, 	gr1
	LD 	gr1, 	$y2%sum
	PUSH 	0, 	gr1
	LAD 	gr1, 	$lc%sum
	PUSH 	0, 	gr1
	CALL $lcm
	LD 	gr1, 	$x1%sum
	PUSH 	0, 	gr1
	LD 	gr1, 	$x1%sum
	LD 	gr1, 	0, 	gr1
	PUSH 	0, 	gr1
	LD 	gr1, 	$lc%sum
	PUSH 	0, 	gr1
	LD 	gr1, 	$x2%sum
	LD 	gr1, 	0, 	gr1
	PUSH 	0, 	gr1
	POP 	gr2
	POP 	gr1
	DIVA 	gr1, 	gr2
	JOV 	E0DIV
	PUSH 	0, 	gr1
	POP 	gr2
	POP 	gr1
	MULA 	gr1, 	gr2
	JOV 	EOVF
	PUSH 	0, 	gr1
	POP 	gr2
	POP 	gr1
	ST 	gr2, 	0, 	gr1
	LAD 	gr1, 	$y11%sum
	PUSH 	0, 	gr1
	LD 	gr1, 	$y1%sum
	LD 	gr1, 	0, 	gr1
	PUSH 	0, 	gr1
	LD 	gr1, 	$lc%sum
	PUSH 	0, 	gr1
	LD 	gr1, 	$y2%sum
	LD 	gr1, 	0, 	gr1
	PUSH 	0, 	gr1
	POP 	gr2
	POP 	gr1
	DIVA 	gr1, 	gr2
	JOV 	E0DIV
	PUSH 	0, 	gr1
	POP 	gr2
	POP 	gr1
	MULA 	gr1, 	gr2
	JOV 	EOVF
	PUSH 	0, 	gr1
	POP 	gr2
	POP 	gr1
	ST 	gr2, 	0, 	gr1
	LD 	gr1, 	$x1%sum
	PUSH 	0, 	gr1
	LD 	gr1, 	$x1%sum
	LD 	gr1, 	0, 	gr1
	PUSH 	0, 	gr1
	LD 	gr1, 	$y11%sum
	PUSH 	0, 	gr1
	POP 	gr2
	POP 	gr1
	ADDA 	gr1, 	gr2
	JOV 	EOVF
	PUSH 	0, 	gr1
	POP 	gr2
	POP 	gr1
	ST 	gr2, 	0, 	gr1
	LD 	gr1, 	$x2%sum
	PUSH 	0, 	gr1
	LD 	gr1, 	$lc%sum
	PUSH 	0, 	gr1
	POP 	gr2
	POP 	gr1
	ST 	gr2, 	0, 	gr1
	LD 	gr1, 	$x1%sum
	PUSH 	0, 	gr1
	LD 	gr1, 	$x2%sum
	PUSH 	0, 	gr1
	CALL $reduce
	RET
$x1%sub 	DC 	0
$x2%sub 	DC 	0
$y1%sub 	DC 	0
$y2%sub 	DC 	0
$lc%sub 	DC 	0
$y11%sub 	DC 	0
$sub	DS	0
	POP	 gr2
	POP gr1
	ST 	gr1, 	$y2%sub
	POP gr1
	ST 	gr1, 	$y1%sub
	POP gr1
	ST 	gr1, 	$x2%sub
	POP gr1
	ST 	gr1, 	$x1%sub
	PUSH 	0, 	gr2
	LD 	gr1, 	$x1%sub
	PUSH 	0, 	gr1
	LD 	gr1, 	$x2%sub
	PUSH 	0, 	gr1
	LD 	gr1, 	$y1%sub
	LD 	gr1, 	0, 	gr1
	PUSH 	0, 	gr1
	LAD 	gr1, 	-1
	PUSH 	0, 	gr1
	POP 	gr2
	POP 	gr1
	MULA 	gr1, 	gr2
	JOV 	EOVF
	PUSH 	0, 	gr1
	LAD 	gr2, 	L0031
	POP 	gr1
	ST 	gr1, 	0, 	gr2
	PUSH 	0, 	gr2
	LD 	gr1, 	$y2%sub
	PUSH 	0, 	gr1
	CALL $sum
	RET
$x1%mult 	DC 	0
$x2%mult 	DC 	0
$y1%mult 	DC 	0
$y2%mult 	DC 	0
$gc%mult 	DC 	0
$y11%mult 	DC 	0
$y22%mult 	DC 	0
$mult	DS	0
	POP	 gr2
	POP gr1
	ST 	gr1, 	$y2%mult
	POP gr1
	ST 	gr1, 	$y1%mult
	POP gr1
	ST 	gr1, 	$x2%mult
	POP gr1
	ST 	gr1, 	$x1%mult
	PUSH 	0, 	gr2
	LD 	gr1, 	$x1%mult
	PUSH 	0, 	gr1
	LD 	gr1, 	$y2%mult
	PUSH 	0, 	gr1
	LAD 	gr1, 	$gc%mult
	PUSH 	0, 	gr1
	CALL $gcm
	LD 	gr1, 	$x1%mult
	PUSH 	0, 	gr1
	LD 	gr1, 	$x1%mult
	LD 	gr1, 	0, 	gr1
	PUSH 	0, 	gr1
	LD 	gr1, 	$gc%mult
	PUSH 	0, 	gr1
	POP 	gr2
	POP 	gr1
	DIVA 	gr1, 	gr2
	JOV 	E0DIV
	PUSH 	0, 	gr1
	POP 	gr2
	POP 	gr1
	ST 	gr2, 	0, 	gr1
	LAD 	gr1, 	$y22%mult
	PUSH 	0, 	gr1
	LD 	gr1, 	$y2%mult
	LD 	gr1, 	0, 	gr1
	PUSH 	0, 	gr1
	LD 	gr1, 	$gc%mult
	PUSH 	0, 	gr1
	POP 	gr2
	POP 	gr1
	DIVA 	gr1, 	gr2
	JOV 	E0DIV
	PUSH 	0, 	gr1
	POP 	gr2
	POP 	gr1
	ST 	gr2, 	0, 	gr1
	LD 	gr1, 	$x2%mult
	PUSH 	0, 	gr1
	LD 	gr1, 	$y1%mult
	PUSH 	0, 	gr1
	LAD 	gr1, 	$gc%mult
	PUSH 	0, 	gr1
	CALL $gcm
	LD 	gr1, 	$x2%mult
	PUSH 	0, 	gr1
	LD 	gr1, 	$x2%mult
	LD 	gr1, 	0, 	gr1
	PUSH 	0, 	gr1
	LD 	gr1, 	$gc%mult
	PUSH 	0, 	gr1
	POP 	gr2
	POP 	gr1
	DIVA 	gr1, 	gr2
	JOV 	E0DIV
	PUSH 	0, 	gr1
	POP 	gr2
	POP 	gr1
	ST 	gr2, 	0, 	gr1
	LAD 	gr1, 	$y11%mult
	PUSH 	0, 	gr1
	LD 	gr1, 	$y1%mult
	LD 	gr1, 	0, 	gr1
	PUSH 	0, 	gr1
	LD 	gr1, 	$gc%mult
	PUSH 	0, 	gr1
	POP 	gr2
	POP 	gr1
	DIVA 	gr1, 	gr2
	JOV 	E0DIV
	PUSH 	0, 	gr1
	POP 	gr2
	POP 	gr1
	ST 	gr2, 	0, 	gr1
	LD 	gr1, 	$x1%mult
	PUSH 	0, 	gr1
	LD 	gr1, 	$x1%mult
	LD 	gr1, 	0, 	gr1
	PUSH 	0, 	gr1
	LD 	gr1, 	$y11%mult
	PUSH 	0, 	gr1
	POP 	gr2
	POP 	gr1
	MULA 	gr1, 	gr2
	JOV 	EOVF
	PUSH 	0, 	gr1
	POP 	gr2
	POP 	gr1
	ST 	gr2, 	0, 	gr1
	LD 	gr1, 	$x2%mult
	PUSH 	0, 	gr1
	LD 	gr1, 	$x2%mult
	LD 	gr1, 	0, 	gr1
	PUSH 	0, 	gr1
	LD 	gr1, 	$y22%mult
	PUSH 	0, 	gr1
	POP 	gr2
	POP 	gr1
	MULA 	gr1, 	gr2
	JOV 	EOVF
	PUSH 	0, 	gr1
	POP 	gr2
	POP 	gr1
	ST 	gr2, 	0, 	gr1
	LD 	gr1, 	$x1%mult
	PUSH 	0, 	gr1
	LD 	gr1, 	$x2%mult
	PUSH 	0, 	gr1
	CALL $reduce
	RET
$x1%divide 	DC 	0
$x2%divide 	DC 	0
$y1%divide 	DC 	0
$y2%divide 	DC 	0
$divide	DS	0
	POP	 gr2
	POP gr1
	ST 	gr1, 	$y2%divide
	POP gr1
	ST 	gr1, 	$y1%divide
	POP gr1
	ST 	gr1, 	$x2%divide
	POP gr1
	ST 	gr1, 	$x1%divide
	PUSH 	0, 	gr2
	LD 	gr1, 	$x1%divide
	PUSH 	0, 	gr1
	LD 	gr1, 	$x2%divide
	PUSH 	0, 	gr1
	LD 	gr1, 	$y2%divide
	PUSH 	0, 	gr1
	LD 	gr1, 	$y1%divide
	PUSH 	0, 	gr1
	CALL $mult
	RET
$a%printfinal 	DC 	0
$b%printfinal 	DC 	0
$printfinal	DS	0
	POP	 gr2
	POP gr1
	ST 	gr1, 	$b%printfinal
	POP gr1
	ST 	gr1, 	$a%printfinal
	PUSH 	0, 	gr2
	LD 	gr1, 	$a%printfinal
	LD 	gr1, 	0, 	gr1
	PUSH 	0, 	gr1
	LAD 	gr1, 	0
	PUSH 	0, 	gr1
	POP 	gr2
	POP 	gr1
	CPA 	gr1, 	gr2
	JZE 	L0032
	LD 	gr1, 	gr0
	PUSH 	0, 	gr1
	JUMP 	L0033
L0032	DS	0
	LAD 	gr1, 	1
	PUSH 	0, 	gr1
L0033	DS	0
	POP 	gr1
	CPA 	gr1, 	gr0
	JZE 	L0034
	LAD 	gr1, L0035
	LD 	gr2, 	gr0
	CALL 	WRITESTR
	LD 	gr1, 	$a%printfinal
	LD 	gr1, 	0, 	gr1
	PUSH 	0, 	gr1
	POP 	gr1
	LAD 	gr2, 	0
	CALL 	WRITEINT
	CALL 	WRITELINE
	JUMP 	L0036
L0034	DS	0
	LD 	gr1, 	$b%printfinal
	LD 	gr1, 	0, 	gr1
	PUSH 	0, 	gr1
	LAD 	gr1, 	1
	PUSH 	0, 	gr1
	POP 	gr2
	POP 	gr1
	CPA 	gr1, 	gr2
	JZE 	L0037
	LD 	gr1, 	gr0
	PUSH 	0, 	gr1
	JUMP 	L0038
L0037	DS	0
	LAD 	gr1, 	1
	PUSH 	0, 	gr1
L0038	DS	0
	POP 	gr1
	CPA 	gr1, 	gr0
	JZE 	L0039
	LAD 	gr1, L0040
	LD 	gr2, 	gr0
	CALL 	WRITESTR
	LD 	gr1, 	$a%printfinal
	LD 	gr1, 	0, 	gr1
	PUSH 	0, 	gr1
	POP 	gr1
	LAD 	gr2, 	0
	CALL 	WRITEINT
	CALL 	WRITELINE
	JUMP 	L0041
L0039	DS	0
	LAD 	gr1, L0042
	LD 	gr2, 	gr0
	CALL 	WRITESTR
	LD 	gr1, 	$a%printfinal
	LD 	gr1, 	0, 	gr1
	PUSH 	0, 	gr1
	POP 	gr1
	LAD 	gr2, 	0
	CALL 	WRITEINT
	LAD 	gr1, 	47
	PUSH 	0, 	gr1
	POP 	gr1
	LAD 	gr2, 	0
	CALL 	WRITECHAR
	LD 	gr1, 	$b%printfinal
	LD 	gr1, 	0, 	gr1
	PUSH 	0, 	gr1
	POP 	gr1
	LAD 	gr2, 	0
	CALL 	WRITEINT
	CALL 	WRITELINE
L0041	DS	0
L0036	DS	0
	RET
$a%printtemp 	DC 	0
$b%printtemp 	DC 	0
$printtemp	DS	0
	POP	 gr2
	POP gr1
	ST 	gr1, 	$b%printtemp
	POP gr1
	ST 	gr1, 	$a%printtemp
	PUSH 	0, 	gr2
	LD 	gr1, 	$a%printtemp
	LD 	gr1, 	0, 	gr1
	PUSH 	0, 	gr1
	LAD 	gr1, 	0
	PUSH 	0, 	gr1
	POP 	gr2
	POP 	gr1
	CPA 	gr1, 	gr2
	JZE 	L0043
	LD 	gr1, 	gr0
	PUSH 	0, 	gr1
	JUMP 	L0044
L0043	DS	0
	LAD 	gr1, 	1
	PUSH 	0, 	gr1
L0044	DS	0
	POP 	gr1
	CPA 	gr1, 	gr0
	JZE 	L0045
	LAD 	gr1, L0046
	LD 	gr2, 	gr0
	CALL 	WRITESTR
	LD 	gr1, 	$a%printtemp
	LD 	gr1, 	0, 	gr1
	PUSH 	0, 	gr1
	POP 	gr1
	LAD 	gr2, 	0
	CALL 	WRITEINT
	CALL 	WRITELINE
	JUMP 	L0047
L0045	DS	0
	LD 	gr1, 	$b%printtemp
	LD 	gr1, 	0, 	gr1
	PUSH 	0, 	gr1
	LAD 	gr1, 	1
	PUSH 	0, 	gr1
	POP 	gr2
	POP 	gr1
	CPA 	gr1, 	gr2
	JZE 	L0048
	LD 	gr1, 	gr0
	PUSH 	0, 	gr1
	JUMP 	L0049
L0048	DS	0
	LAD 	gr1, 	1
	PUSH 	0, 	gr1
L0049	DS	0
	POP 	gr1
	CPA 	gr1, 	gr0
	JZE 	L0050
	LAD 	gr1, L0051
	LD 	gr2, 	gr0
	CALL 	WRITESTR
	LD 	gr1, 	$a%printtemp
	LD 	gr1, 	0, 	gr1
	PUSH 	0, 	gr1
	POP 	gr1
	LAD 	gr2, 	0
	CALL 	WRITEINT
	CALL 	WRITELINE
	JUMP 	L0052
L0050	DS	0
	LAD 	gr1, L0053
	LD 	gr2, 	gr0
	CALL 	WRITESTR
	LD 	gr1, 	$a%printtemp
	LD 	gr1, 	0, 	gr1
	PUSH 	0, 	gr1
	POP 	gr1
	LAD 	gr2, 	0
	CALL 	WRITEINT
	LAD 	gr1, 	47
	PUSH 	0, 	gr1
	POP 	gr1
	LAD 	gr2, 	0
	CALL 	WRITECHAR
	LD 	gr1, 	$b%printtemp
	LD 	gr1, 	0, 	gr1
	PUSH 	0, 	gr1
	POP 	gr1
	LAD 	gr2, 	0
	CALL 	WRITEINT
	CALL 	WRITELINE
L0052	DS	0
L0047	DS	0
	RET
$x1 	DC 	0
$x2 	DC 	0
$y1 	DC 	0
$y2 	DC 	0
$com 	DC 	0
$endflag 	DC 	0
L0001	DS	0
	LAD 	gr1, L0054
	LD 	gr2, 	gr0
	CALL 	WRITESTR
	CALL 	WRITELINE
	LAD 	gr1, 	$x1
	PUSH 	0, 	gr1
	LAD 	gr1, 	0
	PUSH 	0, 	gr1
	POP 	gr2
	POP 	gr1
	ST 	gr2, 	0, 	gr1
	LAD 	gr1, 	$x2
	PUSH 	0, 	gr1
	LAD 	gr1, 	1
	PUSH 	0, 	gr1
	POP 	gr2
	POP 	gr1
	ST 	gr2, 	0, 	gr1
	LAD 	gr1, 	$endflag
	PUSH 	0, 	gr1
	LAD 	gr1, 	0
	PUSH 	0, 	gr1
	POP 	gr2
	POP 	gr1
	ST 	gr2, 	0, 	gr1
L0055	DS	0
	LD 	gr1, 	$endflag
	PUSH 	0, 	gr1
	POP 	gr1
	CPA 	gr1, 	gr0
	JNZ 	L0057
	LAD 	gr1, 1
	PUSH 	0, 	gr1
	JUMP 	L0058
L0057	DS	0
	LD 	gr1, 	gr0
	PUSH 	0, 	gr1
L0058	DS	0
	POP 	gr1
	CPA 	gr1, 	gr0
	JZE 	L0056
	LAD 	gr1, L0059
	LD 	gr2, 	gr0
	CALL 	WRITESTR
	CALL 	WRITELINE
	LAD 	gr1, 	$com
	PUSH 	0, 	gr1
	POP 	gr1
	CALL 	READCHAR
	LAD 	gr1, 	$y1
	PUSH 	0, 	gr1
	POP 	gr1
	CALL 	READINT
	CALL 	READLINE
	LAD 	gr1, 	$y2
	PUSH 	0, 	gr1
	LAD 	gr1, 	1
	PUSH 	0, 	gr1
	POP 	gr2
	POP 	gr1
	ST 	gr2, 	0, 	gr1
	LD 	gr1, 	$com
	PUSH 	0, 	gr1
	LAD 	gr1, 	99
	PUSH 	0, 	gr1
	POP 	gr2
	POP 	gr1
	CPA 	gr1, 	gr2
	JZE 	L0060
	LD 	gr1, 	gr0
	PUSH 	0, 	gr1
	JUMP 	L0061
L0060	DS	0
	LAD 	gr1, 	1
	PUSH 	0, 	gr1
L0061	DS	0
	LD 	gr1, 	$com
	PUSH 	0, 	gr1
	LAD 	gr1, 	67
	PUSH 	0, 	gr1
	POP 	gr2
	POP 	gr1
	CPA 	gr1, 	gr2
	JZE 	L0062
	LD 	gr1, 	gr0
	PUSH 	0, 	gr1
	JUMP 	L0063
L0062	DS	0
	LAD 	gr1, 	1
	PUSH 	0, 	gr1
L0063	DS	0
	POP 	gr2
	POP 	gr1
	OR 	gr1, 	gr2
	PUSH 	0, 	gr1
	POP 	gr1
	CPA 	gr1, 	gr0
	JZE 	L0064
	LAD 	gr1, 	$x1
	PUSH 	0, 	gr1
	LD 	gr1, 	$y1
	PUSH 	0, 	gr1
	POP 	gr2
	POP 	gr1
	ST 	gr2, 	0, 	gr1
	LAD 	gr1, 	$x2
	PUSH 	0, 	gr1
	LD 	gr1, 	$y2
	PUSH 	0, 	gr1
	POP 	gr2
	POP 	gr1
	ST 	gr2, 	0, 	gr1
	JUMP 	L0065
L0064	DS	0
	LD 	gr1, 	$com
	PUSH 	0, 	gr1
	LAD 	gr1, 	43
	PUSH 	0, 	gr1
	POP 	gr2
	POP 	gr1
	CPA 	gr1, 	gr2
	JZE 	L0066
	LD 	gr1, 	gr0
	PUSH 	0, 	gr1
	JUMP 	L0067
L0066	DS	0
	LAD 	gr1, 	1
	PUSH 	0, 	gr1
L0067	DS	0
	POP 	gr1
	CPA 	gr1, 	gr0
	JZE 	L0068
	LAD 	gr1, 	$x1
	PUSH 	0, 	gr1
	LAD 	gr1, 	$x2
	PUSH 	0, 	gr1
	LAD 	gr1, 	$y1
	PUSH 	0, 	gr1
	LAD 	gr1, 	$y2
	PUSH 	0, 	gr1
	CALL $sum
	JUMP 	L0069
L0068	DS	0
	LD 	gr1, 	$com
	PUSH 	0, 	gr1
	LAD 	gr1, 	45
	PUSH 	0, 	gr1
	POP 	gr2
	POP 	gr1
	CPA 	gr1, 	gr2
	JZE 	L0070
	LD 	gr1, 	gr0
	PUSH 	0, 	gr1
	JUMP 	L0071
L0070	DS	0
	LAD 	gr1, 	1
	PUSH 	0, 	gr1
L0071	DS	0
	POP 	gr1
	CPA 	gr1, 	gr0
	JZE 	L0072
	LAD 	gr1, 	$x1
	PUSH 	0, 	gr1
	LAD 	gr1, 	$x2
	PUSH 	0, 	gr1
	LAD 	gr1, 	$y1
	PUSH 	0, 	gr1
	LAD 	gr1, 	$y2
	PUSH 	0, 	gr1
	CALL $sub
	JUMP 	L0073
L0072	DS	0
	LD 	gr1, 	$com
	PUSH 	0, 	gr1
	LAD 	gr1, 	42
	PUSH 	0, 	gr1
	POP 	gr2
	POP 	gr1
	CPA 	gr1, 	gr2
	JZE 	L0074
	LD 	gr1, 	gr0
	PUSH 	0, 	gr1
	JUMP 	L0075
L0074	DS	0
	LAD 	gr1, 	1
	PUSH 	0, 	gr1
L0075	DS	0
	POP 	gr1
	CPA 	gr1, 	gr0
	JZE 	L0076
	LAD 	gr1, 	$x1
	PUSH 	0, 	gr1
	LAD 	gr1, 	$x2
	PUSH 	0, 	gr1
	LAD 	gr1, 	$y1
	PUSH 	0, 	gr1
	LAD 	gr1, 	$y2
	PUSH 	0, 	gr1
	CALL $mult
	JUMP 	L0077
L0076	DS	0
	LD 	gr1, 	$com
	PUSH 	0, 	gr1
	LAD 	gr1, 	47
	PUSH 	0, 	gr1
	POP 	gr2
	POP 	gr1
	CPA 	gr1, 	gr2
	JZE 	L0078
	LD 	gr1, 	gr0
	PUSH 	0, 	gr1
	JUMP 	L0079
L0078	DS	0
	LAD 	gr1, 	1
	PUSH 	0, 	gr1
L0079	DS	0
	POP 	gr1
	CPA 	gr1, 	gr0
	JZE 	L0080
	LD 	gr1, 	$y1
	PUSH 	0, 	gr1
	LAD 	gr1, 	0
	PUSH 	0, 	gr1
	POP 	gr2
	POP 	gr1
	CPA 	gr1, 	gr2
	JZE 	L0081
	LD 	gr1, 	gr0
	PUSH 	0, 	gr1
	JUMP 	L0082
L0081	DS	0
	LAD 	gr1, 	1
	PUSH 	0, 	gr1
L0082	DS	0
	POP 	gr1
	CPA 	gr1, 	gr0
	JZE 	L0083
	LAD 	gr1, L0084
	LD 	gr2, 	gr0
	CALL 	WRITESTR
	CALL 	WRITELINE
	JUMP 	L0085
L0083	DS	0
	LAD 	gr1, 	$x1
	PUSH 	0, 	gr1
	LAD 	gr1, 	$x2
	PUSH 	0, 	gr1
	LAD 	gr1, 	$y1
	PUSH 	0, 	gr1
	LAD 	gr1, 	$y2
	PUSH 	0, 	gr1
	CALL $divide
L0085	DS	0
	JUMP 	L0086
L0080	DS	0
	LD 	gr1, 	$com
	PUSH 	0, 	gr1
	LAD 	gr1, 	111
	PUSH 	0, 	gr1
	POP 	gr2
	POP 	gr1
	CPA 	gr1, 	gr2
	JZE 	L0087
	LD 	gr1, 	gr0
	PUSH 	0, 	gr1
	JUMP 	L0088
L0087	DS	0
	LAD 	gr1, 	1
	PUSH 	0, 	gr1
L0088	DS	0
	LD 	gr1, 	$com
	PUSH 	0, 	gr1
	LAD 	gr1, 	79
	PUSH 	0, 	gr1
	POP 	gr2
	POP 	gr1
	CPA 	gr1, 	gr2
	JZE 	L0089
	LD 	gr1, 	gr0
	PUSH 	0, 	gr1
	JUMP 	L0090
L0089	DS	0
	LAD 	gr1, 	1
	PUSH 	0, 	gr1
L0090	DS	0
	POP 	gr2
	POP 	gr1
	OR 	gr1, 	gr2
	PUSH 	0, 	gr1
	POP 	gr1
	CPA 	gr1, 	gr0
	JZE 	L0091
	LAD 	gr1, 	$endflag
	PUSH 	0, 	gr1
	LAD 	gr1, 	1
	PUSH 	0, 	gr1
	POP 	gr2
	POP 	gr1
	ST 	gr2, 	0, 	gr1
	JUMP 	L0092
L0091	DS	0
	CALL 	WRITELINE
	LAD 	gr1, L0093
	LD 	gr2, 	gr0
	CALL 	WRITESTR
	CALL 	WRITELINE
	LAD 	gr1, L0094
	LD 	gr2, 	gr0
	CALL 	WRITESTR
	CALL 	WRITELINE
	LAD 	gr1, L0095
	LD 	gr2, 	gr0
	CALL 	WRITESTR
	CALL 	WRITELINE
	LAD 	gr1, L0096
	LD 	gr2, 	gr0
	CALL 	WRITESTR
	CALL 	WRITELINE
	LAD 	gr1, L0097
	LD 	gr2, 	gr0
	CALL 	WRITESTR
	CALL 	WRITELINE
	LAD 	gr1, L0098
	LD 	gr2, 	gr0
	CALL 	WRITESTR
	CALL 	WRITELINE
	LAD 	gr1, L0099
	LD 	gr2, 	gr0
	CALL 	WRITESTR
	CALL 	WRITELINE
	CALL 	WRITELINE
L0092	DS	0
L0086	DS	0
L0077	DS	0
L0073	DS	0
L0069	DS	0
L0065	DS	0
	LD 	gr1, 	$endflag
	PUSH 	0, 	gr1
	POP 	gr1
	CPA 	gr1, 	gr0
	JZE 	L0100
	LAD 	gr1, 	$x1
	PUSH 	0, 	gr1
	LAD 	gr1, 	$x2
	PUSH 	0, 	gr1
	CALL $printfinal
	JUMP 	L0101
L0100	DS	0
	LAD 	gr1, 	$x1
	PUSH 	0, 	gr1
	LAD 	gr1, 	$x2
	PUSH 	0, 	gr1
	CALL $printtemp
L0101	DS	0
	JUMP 	L0055
L0056	DS	0
	RET
L0099 	DC 	'  o        : off(terminate execution)'
L0098 	DC 	'  / number : divide by it'
L0097 	DC 	'  * number : multiply it'
L0096 	DC 	'  - number : subtract it'
L0095 	DC 	'  + number : add it'
L0094 	DC 	'  c number : clear & set it'
L0093 	DC 	'Calculator Usage:'
L0084 	DC 	'*** 0-divide error ***'
L0059 	DC 	' Please input command :'
L0054 	DC 	'   *** Calculator -- h for help ***'
L0053 	DC 	'Temporary Result ='
L0051 	DC 	'Temporary Result ='
L0046 	DC 	'Temporary Result ='
L0042 	DC 	'Final Result ='
L0040 	DC 	'Final Result ='
L0035 	DC 	'Final Result ='
L0031 	DC 	0
;-- Library --
EOVF	DS	0
  CALL  WRITELINE
  LAD  gr1, EOVF1
  LD  gr2, gr0
  CALL  WRITESTR
  CALL  WRITELINE
  SVC  1  ;  overflow error stop
EOVF1    DC  '***** Run-Time Error : Overflow *****'
E0DIV	DS	0
  JNZ  EOVF
  CALL  WRITELINE
  LAD  gr1, E0DIV1
  LD  gr2, gr0
  CALL  WRITESTR
  CALL  WRITELINE
  SVC  2  ;  0-divide error stop
E0DIV1    DC  '***** Run-Time Error : Zero-Divide *****'
EROV	DS	0
  CALL  WRITELINE
  LAD  gr1, EROV1
  LD  gr2, gr0
  CALL  WRITESTR
  CALL  WRITELINE
  SVC  3  ;  range-over error stop
EROV1    DC  '***** Run-Time Error : Range-Over in Array Index *****'
WRITECHAR	DS	0
; gr1の値（文字）をgr2のけた数で出力する．
; gr2が0なら必要最小限の桁数で出力する
  RPUSH
  LD  gr6, SPACE
  LD  gr7, OBUFSIZE
WC1	DS	0
  SUBA  gr2, ONE  ; while(--c > 0) {
  JZE  WC2
  JMI  WC2
  ST  gr6, OBUF,gr7  ;  *p++ = ' ';
  CALL  BOVFCHECK
  JUMP  WC1  ; }
WC2	DS	0
  ST  gr1, OBUF,gr7  ; *p++ = gr1;
  CALL  BOVFCHECK
  ST  gr7, OBUFSIZE
  RPOP
  RET
WRITESTR	DS	0
; gr1が指す文字列をgr2のけた数で出力する．
; gr2が0なら必要最小限の桁数で出力する
  RPUSH
  LD  gr6, gr1  ; p = gr1;
WS1	DS	0
  LD  gr4, 0,gr6  ; while(*p != '\0') {
  JZE  WS2
  ADDA  gr6, ONE  ;  p++;
  SUBA  gr2, ONE  ;  c--;
  JUMP  WS1  ; }
WS2	DS	0
  LD  gr7, OBUFSIZE  ; q = OBUFSIZE;
  LD  gr5, SPACE
WS3	DS	0
  SUBA  gr2, ONE  ; while(--c >= 0) {
  JMI  WS4
  ST  gr5, OBUF,gr7  ;  *q++ = ' ';
  CALL  BOVFCHECK
  JUMP  WS3  ; }
WS4	DS	0
  LD  gr4, 0,gr1  ; while(*gr1 != '\0') {
  JZE  WS5
  ST  gr4, OBUF,gr7  ;  *q++ = *gr1++;
  ADDA  gr1, ONE
  CALL  BOVFCHECK
  JUMP  WS4  ; }
WS5	DS	0
  ST  gr7, OBUFSIZE  ; OBUFSIZE = q;
  RPOP
  RET
BOVFCHECK	DS	0
    ADDA  gr7, ONE
    CPA   gr7, BOVFLEVEL
    JMI  BOVF1
    CALL  WRITELINE
    LD gr7, OBUFSIZE
BOVF1	DS	0
    RET
BOVFLEVEL  DC 256
WRITEINT	DS	0
; gr1の値（整数）をgr2のけた数で出力する．
; gr2が0なら必要最小限の桁数で出力する
  RPUSH
  LD  gr7, gr0  ; flag = 0;
  CPA  gr1, gr0  ; if(gr1>=0) goto WI1;
  JPL  WI1
  JZE  WI1
  LD  gr4, gr0  ; gr1= - gr1;
  SUBA  gr4, gr1
  CPA  gr4, gr1
  JZE  WI6
  LD  gr1, gr4
  LD  gr7, ONE  ; flag = 1;
WI1	DS	0
  LD  gr6, SIX  ; p = INTBUF+6;
  ST  gr0, INTBUF,gr6  ; *p = '\0';
  SUBA  gr6, ONE  ; p--;
  CPA  gr1, gr0  ; if(gr1 == 0)
  JNZ  WI2
  LD  gr4, ZERO  ;  *p = '0';
  ST  gr4, INTBUF,gr6
  JUMP  WI5  ; }
WI2	DS	0      ; else {
  CPA  gr1, gr0  ;  while(gr1 != 0) {
  JZE  WI3
  LD  gr5, gr1  ;   gr5 = gr1 - (gr1 / 10) * 10;
  DIVA  gr1, TEN  ;   gr1 /= 10;
  LD  gr4, gr1
  MULA  gr4, TEN
  SUBA  gr5, gr4
  ADDA  gr5, ZERO  ;   gr5 += '0';
  ST  gr5, INTBUF,gr6  ;   *p = gr5;
  SUBA  gr6, ONE  ;   p--;
  JUMP  WI2  ;  }
WI3	DS	0
  CPA  gr7, gr0  ;  if(flag != 0) {
  JZE  WI4
  LD  gr4, MINUS  ;   *p = '-';
  ST  gr4, INTBUF,gr6
  JUMP  WI5  ;  }
WI4	DS	0
  ADDA  gr6, ONE  ;  else p++;
    ; }
WI5	DS	0
  LAD  gr1, INTBUF,gr6  ; gr1 = p;
  CALL  WRITESTR  ; WRITESTR();
  RPOP
  RET
WI6	DS	0
  LAD  gr1, MMINT
  CALL  WRITESTR  ; WRITESTR();
  RPOP
  RET
MMINT    DC  '-32768'
WRITEBOOL	DS	0
; gr1の値（真理値）が0なら'FALSE'を
; 0以外なら'TRUE'をgr2のけた数で出力する．
; gr2が0なら必要最小限の桁数で出力する
  RPUSH
  CPA  gr1, gr0  ; if(gr1 != 0)
  JZE  WB1
  LAD  gr1, WBTRUE  ;  gr1 = " TRUE ";
  JUMP  WB2
WB1	DS	0      ; else
  LAD  gr1, WBFALSE  ;  gr1 = " FALSE ";
WB2	DS	0
  CALL  WRITESTR  ; WRITESTR();
  RPOP
  RET
WBTRUE    DC  'TRUE'
WBFALSE    DC  'FALSE'
WRITELINE	DS	0
; 改行を出力する
  RPUSH
  LD  gr7, OBUFSIZE
  LD  gr6, NEWLINE
  ST  gr6, OBUF,gr7
  ADDA  gr7, ONE
  ST  gr7, OBUFSIZE
  OUT  OBUF, OBUFSIZE
  ST  gr0, OBUFSIZE
  RPOP
  RET
FLUSH	DS	0
  RPUSH
  LD gr7, OBUFSIZE
  JZE FL1
  CALL WRITELINE
FL1	DS	0
  RPOP
  RET
READCHAR	DS	0
; gr1が指す番地に文字一つを読み込む
  RPUSH
  LD  gr5, RPBBUF  ; if(RPBBUF != '\0') {
  JZE  RC0
  ST  gr5, 0,gr1  ;  *gr1 = RPBBUF;
  ST  gr0, RPBBUF  ;  RPBBUF = '\0'
  JUMP  RC3  ;  return; }
RC0	DS	0
  LD  gr7, INP  ; inp = INP;
  LD  gr6, IBUFSIZE  ; if(IBUFSIZE == 0) {
  JNZ  RC1
  IN  IBUF, IBUFSIZE  ;  IN();
  LD  gr7, gr0  ;  inp = 0;
    ; }
RC1	DS	0
  CPA  gr7, IBUFSIZE  ; if(inp == IBUFSIZE) {
  JNZ  RC2
  LD  gr5, NEWLINE  ;  *gr1 = '\n';
  ST  gr5, 0,gr1
  ST  gr0, IBUFSIZE  ;  IBUFSIZE = INP = 0;
  ST  gr0, INP
  JUMP  RC3  ; }
RC2	DS	0      ; else {
  LD  gr5, IBUF,gr7  ;  *gr1 = *inp++;
  ADDA  gr7, ONE
  ST  gr5, 0,gr1
  ST  gr7, INP  ;  INP = inp;
RC3	DS	0      ; }
  RPOP
  RET
READINT	DS	0
;gr1が指す番地に整数値一つを読み込む
  RPUSH
RI1	DS	0      ; do {
  CALL  READCHAR  ;  ch = READCHAR();
  LD  gr7, 0,gr1
  CPA  gr7, SPACE  ; } while(ch == ' ' || ch == '\t' || ch == '\n');
  JZE  RI1
  CPA  gr7, TAB
  JZE  RI1
  CPA  gr7, NEWLINE
  JZE  RI1
  LD  gr5, ONE  ; flag = 1
  CPA  gr7, MINUS  ; if(ch == '-') {
  JNZ  RI4
  LD  gr5, gr0  ;  flag = 0;
  CALL  READCHAR  ;  ch = READCHAR();
  LD  gr7, 0,gr1
RI4	DS	0      ; }
  LD  gr6, gr0  ; v = 0;
RI2	DS	0
  CPA  gr7, ZERO  ; while('0' <= ch && ch <= '9') {
  JMI  RI3
  CPA  gr7, NINE
  JPL  RI3
  MULA  gr6, TEN  ;  v = v*10+ch-'0';
  ADDA  gr6, gr7
  SUBA  gr6, ZERO
  CALL  READCHAR  ;  ch = READSCHAR();
  LD  gr7, 0,gr1
  JUMP  RI2  ; }
RI3	DS	0
  ST  gr7, RPBBUF  ; ReadPushBack();
  ST  gr6, 0,gr1  ; *gr1 = v;
  CPA  gr5, gr0  ; if(flag == 0) {
  JNZ  RI5
  SUBA  gr5, gr6  ;  *gr1 = -v;
  ST  gr5, 0,gr1
RI5	DS	0      ; }
  RPOP
  RET
READLINE	DS	0
; 入力を改行コードまで（改行コードも含む）読み飛ばす
  ST  gr0, IBUFSIZE
  ST  gr0, INP
  ST  gr0, RPBBUF
  RET
ONE    DC  1
SIX    DC  6
TEN    DC  10
SPACE    DC  #0020  ; ' '
MINUS    DC  #002D  ; '-'
TAB    DC  #0009  ; '\t'
ZERO    DC  #0030  ; '0'
NINE    DC  #0039  ; '9'
NEWLINE    DC  #000A  ; '\n'
INTBUF    DS  8
OBUFSIZE  DC  0
IBUFSIZE  DC  0
INP    DC  0
OBUF    DS  257
IBUF    DS  257
RPBBUF    DC  0
	END
